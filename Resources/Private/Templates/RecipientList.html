<f:layout name="Default" />

<f:section name="content">
<f:flashMessages />
<f:if condition="{show}">
    <f:variable name="lll" value="LLL:EXT:direct_mail/Resources/Private/Language/locallang_mod2-6.xlf:" />
    <f:variable name="lll4" value="LLL:EXT:core/Resources/Private/Language/locallang_general.xlf:" />
    
    <h1><f:translate key="{lll}mailgroup_header" /></h1>
    <f:if condition="{type} == 1">
        <h3><f:translate key="{lll}subscriber_info" /></h3>
        <f:format.html>{data.icon}</f:format.html> <f:format.html>{data.name}</f:format.html> &lt;<f:format.html>{data.email}</f:format.html>&gt;
        &nbsp;&nbsp;
        <a href="#" onClick="{data.editOnClickLink}" title="{f:translate(key: '{lll}dmail_edit')}">
            <f:format.html>{data.iconActionsOpen}</f:format.html>
            <b><f:translate key="{lll}dmail_edit" /></b>
        </a>
        <div style="padding-top: 20px;"></div>
        <h3><f:translate key="{lll}subscriber_profile" /></h3>
        <f:translate key="{lll}subscriber_profile_instructions" />
        <br /><br />
        <f:form method="post" name="dmailform" enctype="multipart/form-data">
	        <f:for each="{data.categories}" as="cat">
	            <f:form.checkbox name="indata[categories][{data.uid}][{cat.pkey}]" value="1" checked="{cat.checked} == 1" /> <f:format.html>{cat.pVal}</f:format.html>
	            <br />
	        </f:for>
            <br /><br />
            <f:form.checkbox name="indata[html]" value="1" checked="{data.html} == 1" /> <f:translate key="{lll}subscriber_profile_htmlemail" />
            <br />
            <f:form.hidden name="table" value="{data.table}" />
            <f:form.hidden name="uid" value="{data.thisID}" />
            <f:form.hidden name="cmd" value="{data.cmd}" />
            <br />
            <f:form.submit value="{f:translate(key: '{lll}subscriber_profile_update')}" />
        </f:form>
    </f:if>
    <f:if condition="{type} == 2">
        <h3><f:translate key="{lll}mailgroup_recip_from" /> <f:format.html>{data.group_icon} {data.group_title}</f:format.html></h3>
        <f:translate key="{lll}mailgroup_recip_number" /> <strong>{data.group_totalRecipients}</strong>
        <f:if condition="{data.group_link_listall}">
            <br /><br /><strong><a class="t3-link" href="{data.group_link_listall}"><f:translate key="{lll}mailgroup_list_all" /></a></strong>
        </f:if>
        <div style="padding-top: 20px;"></div>
        <f:if condition="{data.tables -> f:count()}">
            <f:for each="{data.tables}" as="table">
		        <f:if condition="{table.title_table}">
		            <h3><f:translate key="{lll}{table.title_table}" />{table.table_custom}</h3>
		            <div style="padding-top: 20px;"></div>
		        </f:if>
		        <f:if condition="{table.title_recip}">
		            <f:translate key="{lll}{table.title_recip}" />{table.recip_counter}
		            <br />
		            <a href="{table.mailgroup_download_link}" class="t3-link"><f:translate key="{lll}mailgroup_download" /></a>
		        </f:if>
		        <f:format.html>{table.recip_list}</f:format.html>
            </f:for>
        </f:if>
        <f:if condition="{data.special}">
            <div style="padding-top: 20px;"></div>
            <h3><f:translate key="{lll}dmail_query" /></h3>
            
            <h3><f:translate key="{lll}dmail_makeQuery" /></h3>
            
            <f:form action="" method="post" name="dmailform" enctype="multipart/form-data">
                <f:if condition="{data.special.selected}">
                    {data.special.selected}
                    <div style="padding-top: 20px;"></div>
                </f:if>
                {data.special.selectTables}
                <f:form.hidden name="cmd" value="displayMailGroup" />
                <f:form.hidden name="group_uid" value="{data.group_id}" />
	            <f:form.submit value="{f:translate(key: '{lll}dmail_updateQuery')}" />
            </f:form>
        </f:if>
    </f:if>
    <f:if condition="{type} == 4">
        <h3><f:translate key="{lll}recip_select_mailgroup" /></h3>
        <table class="table table-striped table-hover">
            <thead>
                <th colspan="2">&nbsp;</th>
                <th><f:translate key="{lll4}LGL.title" /></th>
                <th><f:translate key="{lll4}LGL.type" /></th>
                <th><f:translate key="{lll4}LGL.description" /></th>
                <th><f:translate key="{lll}recip_group_amount" /></th>
            </thead>
            <f:for each="{data.rows}" as="row">
                <tr class="db_list_normal">
                    <td nowrap="nowrap"><f:format.html>{row.icon}</f:format.html></td>
                    <td><f:format.html>{row.editLink}</f:format.html></td>
                    <td nowrap="nowrap"><f:format.html>{row.reciplink}</f:format.html></td>
                    <td nowrap="nowrap"><f:format.html>{row.type}</f:format.html></td>
                    <td nowrap="nowrap"><f:format.html>{row.description}</f:format.html></td>
                    <td>{row.count}</td>
                </tr>
            </f:for>
        </table>
        <div style="padding-top: 20px;"></div>
        <h3><f:translate key="{lll}recip_select_mailgroup" /></h3>
        <a href="#" class="t3-link" onClick="{data.editOnClickLink}">
            <f:format.html>{data.sysDmailGroupIcon}</f:format.html> <f:translate key="{lll}recip_create_mailgroup_msg" />
        </a>
        <div style="padding-top: 20px;"></div>
        <h3><f:translate key="{lll}mailgroup_import" /></h3>
        <a class="t3-link" href="{data.moduleUrl}"> <f:translate key="{lll}recip_import_mailgroup_msg" /></a>
    </f:if>
    <f:if condition="{type} == 3">
		<div>
			<h2>{formcontent.output.title}</h2>
			<hr style="border:solid;"/>
			<h3>{formcontent.output.subtitle}</h3>
			<f:form action="" method="post" name="dmailform" enctype="multipart/form-data">
				<f:if condition="{formcontent.output.upload.show}">
					<f:translate key="{lll}mailgroup_import_upload_file" /> <f:form.upload name="upload_1" /><br>
					<f:if condition="{formcontent.output.upload.current}">
						<f:translate key="{lll}mailgroup_import_current_file" /><br>
					</f:if>
					<br>
					<p><b><f:translate key="{lll}mailgroup_import_or" /></b></p><br>
					<f:translate key="{lll}mailgroup_import_paste_csv" /><br>
					<f:form.textarea name="CSV_IMPORT[csv]" class="form-control formengine-textarea">{formcontent.output.upload.csv}</f:form.textarea><br><br>
					<f:form.submit name="CSV_IMPORT[next]" value="{f:translate(key: '{lll}mailgroup_import_next')}" />
					<f:form.hidden name="cmd" value="displayImport" />
					<f:form.hidden name="importStep[next]" value="conf" />
					<f:form.hidden name="file[upload][1][data]" value="1" />
					<input type="hidden" name="file[upload][1][target]" value="{formcontent.output.upload.target}" {f:if(condition: '{formcontent.output.upload.target_disabled}', then: 'disabled')} />
					<f:form.hidden name="CSV_IMPORT[newFile]" value ="{formcontent.output.upload.newFile}" />
				</f:if>
				<f:if condition="{formcontent.output.conf.show}">
					<table class="table table-striped table-hover">
						<tbody>
							<tr class="db_list_normal">
								<td width="300">
									<f:translate key="{lll}mailgroup_import_header_conf" />
								</td>
								<td nowrap="">
									<f:format.html>{formcontent.output.conf.storage}</f:format.html>
								</td>
							</tr>
							<tr class="db_list_normal">
								<td width="300">
									<f:translate key="{lll}mailgroup_import_remove_existing" />
								</td>
								<td nowrap="">
									<f:form.checkbox name="CSV_IMPORT[remove_existing]" value="1" checked="{formcontent.output.conf.remove_existing} == 1" disabled="{f:if(condition: '{formcontent.output.conf.disableInput}', then: 'disabled')}" />
								</td>
							</tr>
							<tr class="db_list_normal">
								<td width="300">
									<f:translate key="{lll}mailgroup_import_first_fieldnames" />
								</td>
								<td nowrap="">
									<f:form.checkbox name="CSV_IMPORT[first_fieldname]" value="1" checked="{formcontent.output.conf.first_fieldname} == 1" disabled="{f:if(condition: '{formcontent.output.conf.disableInput}', then: 'disabled')}" />
								</td>
							</tr>
							<tr class="db_list_normal">
								<td width="300">
									<f:translate key="{lll}mailgroup_import_separator" />
								</td>
								<td nowrap="">
									<f:format.html>{formcontent.output.conf.delimiter}</f:format.html>
								</td>
							</tr>
							<tr class="db_list_normal">
								<td width="300">
									<f:translate key="{lll}mailgroup_import_encapsulation" />
								</td>
								<td nowrap="">
									<f:format.html>{formcontent.output.conf.encapsulation}</f:format.html>
								</td>
							</tr>
							<tr class="db_list_normal">
								<td width="300">
									<f:translate key="{lll}mailgroup_import_csv_validemail-description" />
								</td>
								<td nowrap="">
									<f:form.checkbox name="CSV_IMPORT[valid_email]" value="1" checked="{formcontent.output.conf.valid_email} == 1" disabled="{f:if(condition: '{formcontent.output.conf.disableInput}', then: 'disabled')}" />
								</td>
							</tr>
							<tr class="db_list_normal">
								<td width="300">
									<f:translate key="{lll}mailgroup_import_csv_dublette-description" />
								</td>
								<td nowrap="">
									<f:form.checkbox name="CSV_IMPORT[remove_dublette]" value="1" checked="{formcontent.output.conf.remove_dublette} == 1" disabled="{f:if(condition: '{formcontent.output.conf.disableInput}', then: 'disabled')}" />
								</td>
							</tr>
							<tr class="db_list_normal">
								<td width="300">
									<f:translate key="{lll}mailgroup_import_update_unique" />
								</td>
								<td nowrap="">
									<f:form.checkbox name="CSV_IMPORT[update_unique]" value="1" checked="{formcontent.output.conf.update_unique} == 1" disabled="{f:if(condition: '{formcontent.output.conf.disableInput}', then: 'disabled')}" />
								</td>
							</tr>
							<tr class="db_list_normal">
								<td width="300">
									<f:translate key="{lll}mailgroup_import_record_unique" />
								</td>
								<td nowrap="">
									<f:format.html>{formcontent.output.conf.record_unique}</f:format.html>
								</td>
							</tr>
						</tbody>
					</table>
					<br />
					<f:form.submit name="CSV_IMPORT[back]" value="{f:translate(key: '{lll}mailgroup_import_back')}" />
					<f:form.submit name="CSV_IMPORT[next]" value="{f:translate(key: '{lll}mailgroup_import_next')}" />
					<f:form.hidden name="cmd" value="displayImport" />
					<f:form.hidden name="importStep[next]" value="mapping" />
					<f:form.hidden name="importStep[back]" value="upload" />
					<f:form.hidden name="CSV_IMPORT[newFile]" value="{formcontent.output.conf.newFile}" />
				</f:if>
				<f:if condition="{formcontent.theOutput}">
					<f:format.raw>{formcontent.theOutput}</f:format.raw>
				</f:if>
	        </f:form>
        </div>
    </f:if>
</f:if>
</f:section>
